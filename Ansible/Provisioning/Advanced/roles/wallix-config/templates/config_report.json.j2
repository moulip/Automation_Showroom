{
  "report_info": {
    "hostname": "{{ inventory_hostname }}",
    "timestamp": "{{ ansible_date_time.iso8601 }}",
    "ansible_version": "{{ ansible_version.full }}",
    "role": "wallix-config",
    "operation_mode": "{{ wallix_config.operation_mode | default('apply') }}"
  },
  "validation_status": {
    "config_validated": {{ wallix_config_validated | default(false) | to_json }},
    "validation_time": "{{ wallix_config_validation_time | default('N/A') }}"
  },
  "backup_status": {
    "backup_created": {{ wallix_config_backup_created | default(false) | to_json }},
    "backup_file": "{{ wallix_config_backup_file | default('N/A') }}",
    "backup_time": "{{ wallix_config_backup_time | default('N/A') }}"
  },
  "system_config": {
    "applied": {{ wallix_system_config_applied | default(false) | to_json }},
    "timestamp": "{{ wallix_system_config_time | default('N/A') }}",
    "configuration": {{ wallix_system_config | default({}) | to_json }}
  },
  "license_status": {
    "installed": {{ wallix_license_installed | default(false) | to_json }},
    "valid": {{ wallix_license_valid | default(true) | to_json }},
    "days_remaining": "{{ wallix_license_days_remaining | default('unknown') }}",
    "check_time": "{{ wallix_license_check_time | default('N/A') }}"
  },
  "certificate_status": {
    "web_cert_installed": {{ wallix_web_cert_installed | default(false) | to_json }},
    "certificates_valid": {{ wallix_certificates_valid | default(true) | to_json }},
    "config_time": "{{ wallix_certificates_config_time | default('N/A') }}"
  },
  "time_config": {
    "applied": {{ wallix_time_config_applied | default(false) | to_json }},
    "synchronized": {{ wallix_time_synchronized | default(false) | to_json }},
    "config_time": "{{ wallix_time_config_time | default('N/A') }}"
  },
  "network_config": {
    "interfaces_applied": {{ wallix_network_interfaces_applied | default(false) | to_json }},
    "firewall_applied": {{ wallix_firewall_config_applied | default(false) | to_json }},
    "test_passed": {{ wallix_network_test_passed | default(true) | to_json }},
    "config_time": "{{ wallix_network_config_time | default('N/A') }}"
  },
  "backup_config": {
    "applied": {{ wallix_backup_config_applied | default(false) | to_json }},
    "test_passed": {{ wallix_backup_test_passed | default(true) | to_json }},
    "config_time": "{{ wallix_backup_config_time | default('N/A') }}"
  },
  "summary": {
    "total_changes": {{ (
      (wallix_system_config_applied | default(false)) +
      (wallix_license_installed | default(false)) +
      (wallix_web_cert_installed | default(false)) +
      (wallix_time_config_applied | default(false)) +
      (wallix_network_interfaces_applied | default(false)) +
      (wallix_firewall_config_applied | default(false)) +
      (wallix_backup_config_applied | default(false))
    ) | int }},
    "status": "{{ 'completed' if wallix_config_completed | default(false) else 'partial' }}",
    "completion_time": "{{ wallix_config_completion_time | default('N/A') }}"
  }
}